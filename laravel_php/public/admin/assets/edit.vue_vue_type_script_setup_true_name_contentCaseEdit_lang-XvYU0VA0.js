import{D as T,a6 as q,a7 as A,B as G,C as K,_ as O,F as $,h as z,g as H}from"./element-plus-Dexv8m38.js";import{_ as J}from"./index.vue_vue_type_style_index_0_lang-BbQVWiJS.js";import{r as i}from"./index-RwF53efZ.js";import{p as M}from"./project-CreSpfIK.js";import{P as Q}from"./index-CiZ7u30k.js";import{_ as W}from"./picker-B75jrQ9B.js";import{d as x,r as m,b as X,a0 as Y,K as Z,o as p,u as a,L as r,U as s,a as y,c as v,P as ee,T as te,ab as oe,R as ae,S as se}from"./@vue-ygbFPFRc.js";function Ve(n){return i.get({url:"/content.case/lists",params:n})}function le(n){return i.get({url:"/content.case/detail",params:n})}function ne(n){return i.post({url:"/content.case/add",params:n})}function re(n){return i.post({url:"/content.case/edit",params:n})}function we(n){return i.post({url:"/content.case/delete",params:n})}function be(n){return i.post({url:"/content.case/status",params:n})}function ye(n){return i.post({url:"/content.case/featured",params:n})}const ue={class:"w-full border rounded p-3 max-h-[200px] overflow-y-auto bg-gray-50"},ie={key:0,class:"text-gray-400 text-center py-2"},de=x({name:"contentCaseEdit"}),xe=x({...de,emits:["success","close"],setup(n,{expose:h,emit:E}){const g=E,_=m(),V=m(),f=m("add"),d=m([]),k=X(()=>f.value==="add"?"添加案例":"编辑案例"),e=Y({id:0,project_ids:[],title:"",summary:"",cover:"",images:[],content:"",tags:"",sort:0,is_featured:1,is_show:1}),C=async()=>{try{const u=await M();d.value=u||[]}catch(u){console.error("获取项目列表失败:",u),d.value=[]}},j={title:[{required:!0,message:"请输入标题",trigger:"blur"}]},U=()=>{e.id=0,e.project_ids=[],e.title="",e.summary="",e.cover="",e.images=[],e.content="",e.tags="",e.sort=0,e.is_featured=1,e.is_show=1},R=async(u,t)=>{var c;if(f.value=u,U(),(c=_.value)==null||c.open(),await C(),u==="edit"&&t){const o=await le({id:t});e.id=o.id,e.project_ids=o.project_ids||[],e.title=o.title||"",e.summary=o.summary||"",e.cover=o.cover||"",e.images=o.images||[],e.content=o.content||"",e.tags=o.tags||"",e.sort=o.sort||0,e.is_featured=o.is_featured??0,e.is_show=o.is_show??1}},F=async()=>{var u,t;await((u=V.value)==null?void 0:u.validate()),f.value==="edit"?await re(e):await ne(e),(t=_.value)==null||t.close(),g("success")},B=()=>{g("close")};return h({open:R}),(u,t)=>{const c=K,o=G,D=$,L=O,N=z,w=H,b=A,S=J,P=q,I=T;return p(),Z(Q,{ref_key:"popupRef",ref:_,title:a(k),async:!0,width:"900px",onConfirm:F,onClose:B},{default:r(()=>[s(I,{ref_key:"formRef",ref:V,model:a(e),rules:j,"label-width":"100px"},{default:r(()=>[s(P,{gutter:20},{default:r(()=>[s(b,{span:12},{default:r(()=>[s(o,{label:"标题",prop:"title"},{default:r(()=>[s(c,{modelValue:a(e).title,"onUpdate:modelValue":t[0]||(t[0]=l=>a(e).title=l),placeholder:"请输入标题",maxlength:"150","show-word-limit":""},null,8,["modelValue"])]),_:1}),s(o,{label:"封面图",prop:"cover"},{default:r(()=>[s(W,{modelValue:a(e).cover,"onUpdate:modelValue":t[1]||(t[1]=l=>a(e).cover=l),limit:1},null,8,["modelValue"])]),_:1}),s(o,{label:"项目类型",prop:"project_ids"},{default:r(()=>[y("div",ue,[s(L,{modelValue:a(e).project_ids,"onUpdate:modelValue":t[2]||(t[2]=l=>a(e).project_ids=l)},{default:r(()=>[(p(!0),v(te,null,oe(a(d),l=>(p(),v("div",{key:l.id,class:"py-1"},[s(D,{value:l.id},{default:r(()=>[ae(se(l.name),1)]),_:2},1032,["value"])]))),128))]),_:1},8,["modelValue"]),!a(d)||a(d).length===0?(p(),v("div",ie,' 暂无项目类型，请先在"项目配置"中添加 ')):ee("",!0)])]),_:1}),s(o,{label:"排序",prop:"sort"},{default:r(()=>[s(N,{modelValue:a(e).sort,"onUpdate:modelValue":t[3]||(t[3]=l=>a(e).sort=l),min:0,max:9999},null,8,["modelValue"]),t[7]||(t[7]=y("div",{class:"form-tips"},"数值越大越靠前",-1))]),_:1}),s(o,{label:"加精",prop:"is_featured"},{default:r(()=>[s(w,{modelValue:a(e).is_featured,"onUpdate:modelValue":t[4]||(t[4]=l=>a(e).is_featured=l),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),s(o,{label:"上架状态",prop:"is_show"},{default:r(()=>[s(w,{modelValue:a(e).is_show,"onUpdate:modelValue":t[5]||(t[5]=l=>a(e).is_show=l),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1}),s(b,{span:12},{default:r(()=>[s(o,{label:"内容详情",prop:"content"},{default:r(()=>[s(S,{modelValue:a(e).content,"onUpdate:modelValue":t[6]||(t[6]=l=>a(e).content=l),height:500},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])}}});export{xe as _,we as a,be as b,Ve as c,ye as d};
