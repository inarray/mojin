import{D as L,B as O,O as R,P as V,E as f}from"./element-plus-Dexv8m38.js";import{j as $}from"./consumer-B-5sexIM.js";import{g as D}from"./employee-CJ8eLApb.js";import{P}from"./index-CiZ7u30k.js";import{d as S,r as m,a0 as U,K as y,o as p,L as l,U as i,u as a,c as j,T as q,ab as z}from"./@vue-ygbFPFRc.js";const G=S({__name:"assign-popup",props:{customerId:{}},emits:["success","close"],setup(g,{expose:b,emit:E}){const h=g,u=E,n=m(),r=m(),s=U({employee_id:""}),v={employee_id:[{required:!0,message:"请选择业务员",trigger:"change"}]},_=m([]),k=async()=>{try{const e=await D({page_no:1,page_size:200});_.value=(e==null?void 0:e.lists)||[]}catch(e){console.error(e)}},w=e=>{const o=e.real_name||e.nickname||e.account||`ID:${e.id}`,c=e.mobile?` (${e.mobile})`:"";return`${o}${c}`},x=()=>{var e;(e=n.value)==null||e.open(),k()},C=async()=>{var e;await((e=r.value)==null?void 0:e.validate());try{await $({customer_id:h.customerId,employee_id:s.employee_id}),f.success("分配成功"),u("success"),d()}catch(o){f.error(o.msg||"分配失败")}},d=()=>{var e,o;(e=r.value)==null||e.resetFields(),s.employee_id="",(o=n.value)==null||o.close(),u("close")};return b({open:x}),(e,o)=>{const c=V,B=R,F=O,I=L;return p(),y(P,{ref_key:"popupRef",ref:n,title:"分配跟进",async:!0,width:"500px",onConfirm:C,onClose:d},{default:l(()=>[i(I,{ref_key:"formRef",ref:r,model:a(s),rules:v,"label-width":"100px"},{default:l(()=>[i(F,{label:"接手业务员",prop:"employee_id"},{default:l(()=>[i(B,{modelValue:a(s).employee_id,"onUpdate:modelValue":o[0]||(o[0]=t=>a(s).employee_id=t),placeholder:"请选择业务员",filterable:"",class:"w-full"},{default:l(()=>[(p(!0),j(q,null,z(a(_),t=>(p(),y(c,{key:t.id,label:w(t),value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},512)}}});export{G as _};
