import{D as L,B as O,O as R,P as $,C as D,E as y}from"./element-plus-Dexv8m38.js";import{t as P}from"./consumer-B-5sexIM.js";import{g as U}from"./employee-CJ8eLApb.js";import{P as S}from"./index-CiZ7u30k.js";import{d as q,r as m,a0 as z,K as b,o as u,L as a,U as r,u as s,c as K,T as M,ab as N}from"./@vue-ygbFPFRc.js";const J=q({__name:"transfer-popup",props:{customerId:{}},emits:["success","close"],setup(g,{expose:E,emit:v}){const h=g,_=v,n=m(),p=m(),t=z({to_employee_id:"",reason:""}),w={to_employee_id:[{required:!0,message:"请选择接手业务员",trigger:"change"}]},i=m([]),k=async()=>{try{const e=await U({page_no:1,page_size:200});i.value=(e==null?void 0:e.lists)||[]}catch(e){console.error(e)}},x=e=>{const o=e.real_name||e.nickname||e.account||`ID:${e.id}`,c=e.mobile?` (${e.mobile})`:"";return`${o}${c}`},C=()=>{var e;(e=n.value)==null||e.open(),k()},V=async()=>{var e;await((e=p.value)==null?void 0:e.validate());try{await P({customer_id:h.customerId,to_employee_id:t.to_employee_id,reason:t.reason}),y.success("转移成功"),_("success"),d()}catch(o){y.error(o.msg||"转移失败")}},d=()=>{var e,o;(e=p.value)==null||e.resetFields(),t.to_employee_id="",t.reason="",(o=n.value)==null||o.close(),_("close")};return E({open:C}),(e,o)=>{const c=$,I=R,f=O,B=D,F=L;return u(),b(S,{ref_key:"popupRef",ref:n,title:"转移客户",async:!0,width:"500px",onConfirm:V,onClose:d},{default:a(()=>[r(F,{ref_key:"formRef",ref:p,model:s(t),rules:w,"label-width":"100px"},{default:a(()=>[r(f,{label:"接手业务员",prop:"to_employee_id"},{default:a(()=>[r(I,{modelValue:s(t).to_employee_id,"onUpdate:modelValue":o[0]||(o[0]=l=>s(t).to_employee_id=l),placeholder:"请选择接手业务员",filterable:"",class:"w-full"},{default:a(()=>[(u(!0),K(M,null,N(s(i),l=>(u(),b(c,{key:l.id,label:x(l),value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(f,{label:"转移原因",prop:"reason"},{default:a(()=>[r(B,{modelValue:s(t).reason,"onUpdate:modelValue":o[1]||(o[1]=l=>s(t).reason=l),type:"textarea",rows:3,placeholder:"请输入转移原因"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},512)}}});export{J as _};
