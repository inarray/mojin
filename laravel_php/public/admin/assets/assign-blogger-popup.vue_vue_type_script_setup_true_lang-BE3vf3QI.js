import{D as P,B as S,O as D,P as M,R as U,L as q,M as A,E as h}from"./element-plus-Dexv8m38.js";import{h as K,i as $}from"./consumer-B-5sexIM.js";import{P as j}from"./index-CiZ7u30k.js";import{d as G,r as m,a0 as H,K as r,o as t,L as o,U as a,u as i,c as J,T as Q,ab as W,a as k,P as X,S as u,R as c}from"./@vue-ygbFPFRc.js";const se=G({__name:"assign-blogger-popup",props:{customerId:{}},emits:["success","close"],setup(B,{expose:C,emit:x}){const b=B,y=x,_=m(),d=m(),n=H({blogger_admin_id:""}),V={blogger_admin_id:[{required:!0,message:"请选择博主",trigger:"change"}]},v=m([]),p=m([]),R=async()=>{try{const e=await $({page_no:1,page_size:200,customer_id:b.customerId});v.value=(e==null?void 0:e.lists)||[],p.value=(e==null?void 0:e.history)||[]}catch(e){console.error(e)}},z=()=>{var e;(e=_.value)==null||e.open(),R()},L=async()=>{var e;await((e=d.value)==null?void 0:e.validate());try{await K({customer_id:b.customerId,blogger_admin_id:n.blogger_admin_id}),h.success("分配成功"),y("success"),w()}catch(l){h.error(l.msg||"分配失败")}},w=()=>{var e,l;(e=d.value)==null||e.resetFields(),n.blogger_admin_id="",p.value=[],(l=_.value)==null||l.close(),y("close")},O=e=>{const l=e.name||e.account||"";return e.is_left?`${l}（离）`:l};return C({open:z}),(e,l)=>{const g=U,T=M,F=D,E=S,f=A,I=q,N=P;return t(),r(j,{ref_key:"popupRef",ref:_,title:"对接咨询（分配博主）",async:!0,width:"500px",onConfirm:L,onClose:w},{default:o(()=>[a(N,{ref_key:"formRef",ref:d,model:i(n),rules:V,"label-width":"100px"},{default:o(()=>[a(E,{label:"选择博主",prop:"blogger_admin_id"},{default:o(()=>[a(F,{modelValue:i(n).blogger_admin_id,"onUpdate:modelValue":l[0]||(l[0]=s=>i(n).blogger_admin_id=s),placeholder:"请选择博主",filterable:"",class:"w-full"},{default:o(()=>[(t(!0),J(Q,null,W(i(v),s=>(t(),r(T,{key:s.id,label:O(s),value:s.id},{default:o(()=>[k("span",null,u(s.name||s.account),1),s.is_left?(t(),r(g,{key:0,size:"small",type:"info",class:"ml-2"},{default:o(()=>l[1]||(l[1]=[c("离")])),_:1})):X("",!0)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(E,{label:"对接记录"},{default:o(()=>[a(I,{data:i(p),size:"small",class:"w-full"},{default:o(()=>[a(f,{label:"博主","min-width":"140"},{default:o(({row:s})=>[k("span",null,u(s.blogger_name||"-"),1),s.status===0?(t(),r(g,{key:0,size:"small",type:"info",class:"ml-2"},{default:o(()=>l[2]||(l[2]=[c("离")])),_:1})):(t(),r(g,{key:1,size:"small",type:"success",class:"ml-2"},{default:o(()=>l[3]||(l[3]=[c("跟进中")])),_:1}))]),_:1}),a(f,{label:"分配人","min-width":"120"},{default:o(({row:s})=>[c(u(s.assigner_name||"-"),1)]),_:1}),a(f,{label:"时间","min-width":"160"},{default:o(({row:s})=>[c(u(s.create_time||"-"),1)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["model"])]),_:1},512)}}});export{se as _};
