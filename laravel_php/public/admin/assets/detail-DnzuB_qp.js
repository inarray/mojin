import{N as se,I as ne,T as re,U as ue,R as pe,i as _e,L as de,M as ie,V as ce,W as fe,X as me,G as ye,Y as be}from"./element-plus-Dexv8m38.js";import{e as ge,f as ke,g as ve}from"./report-Dk0xVeLs.js";import{_ as we}from"./follow-popup.vue_vue_type_script_setup_true_lang-iUU6Z23A.js";import{_ as xe}from"./assign-blogger-popup.vue_vue_type_script_setup_true_lang-CeyPLwPX.js";import{_ as he}from"./transfer-popup.vue_vue_type_script_setup_true_lang-DEoFXNQP.js";import{u as Te}from"./vue-router-Cg6aTb_d.js";import{d as U,b as Ee,a0 as Re,r as c,l as Ce,at as Be,c as b,o as p,U as o,K as d,P as i,L as e,R as s,S as n,u as a,a as f,T as I,ab as M,O as Pe,M as S,i as De,n as V}from"./@vue-ygbFPFRc.js";import"./@element-plus-X4lX9UBP.js";import"./lodash-es-C1lm3Iro.js";import"./dayjs-Bnps4p3p.js";import"./@popperjs-D_chPuIy.js";import"./async-validator-9PlIezaS.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./index-RwF53efZ.js";import"./nprogress-UhqZPtFR.js";import"./pinia-CfRoOCaL.js";import"./axios-DIsA03vz.js";import"./lodash-CMKdTQec.js";import"./@vueuse-yz9uDhpq.js";import"./css-color-function-rr4n3v1N.js";import"./balanced-match-BdS7OldZ.js";import"./color-DYO1E7y4.js";import"./clone-Ddk2tjDh.js";import"./color-convert-DsNsD289.js";import"./color-name-Dju3oUBS.js";import"./color-string-pUQDDJII.js";import"./ms-CzQ2E3wO.js";import"./vue-clipboard3-BWi338pc.js";import"./clipboard-7pJsftR6.js";import"./echarts-CXZcVnUo.js";import"./tslib-BDyQ-Jie.js";import"./zrender-DO4NV0px.js";import"./highlight.js-BLB-XFKK.js";import"./@highlightjs-DS9t1Xn3.js";import"./index-CiZ7u30k.js";import"./blogger-Yc_pWcVi.js";import"./employee-CJ8eLApb.js";const Se={key:1},Ve={key:1},$e={class:"mt-4 flex gap-2"},Fe={class:"flex items-center justify-between"},Le={class:"flex items-center justify-between mb-2"},Ne={class:"ml-2 font-bold"},Oe={key:0,class:"text-gray-700 mb-2"},je=U({name:"reportDetail"}),Tt=U({...je,setup(ze){const A=Te(),g=Ee(()=>Number(A.query.id)),_=Re({}),k=c("all"),w=c([]),$=c([]),F=c([]),x=c(!1),h=c(!1),T=c(!1),L=c(),N=c(),O=c(),v=async()=>{try{const t=await ge({id:g.value});Object.assign(_,t)}catch(t){console.error(t)}},E=async()=>{try{const t=await ke({report_id:g.value,type:k.value});w.value=(t==null?void 0:t.lists)||[]}catch(t){console.error(t)}},G=async()=>{try{const t=await ve();$.value=t.stage_options||[],F.value=t.customer_type_options||[]}catch(t){console.error(t)}},q=t=>({1:"info",2:"",3:"warning",4:"primary",5:"success",51:"danger",6:"success"})[t]||"",H=t=>({1:"primary",2:"success",3:"info"})[t]||"",K=t=>({overdue:"text-red-500 font-bold",today:"text-orange-500 font-bold",future:"text-green-500",none:""})[t]||"",W=t=>t.customer_type_desc||t.budget||t.style_pref||t.concern||t.handoff_status||t.latest_status||t.next_plan||t.next_follow_time||t.remark,X=()=>{x.value=!0,V(()=>{var t;(t=L.value)==null||t.open()})},Y=()=>{v(),E()},J=()=>{h.value=!0,V(()=>{var t;(t=N.value)==null||t.open()})},Q=()=>{T.value=!0,V(()=>{var t;(t=O.value)==null||t.open()})};return Ce(()=>{v(),E(),G()}),(t,r)=>{var j;const Z=se,m=ne,u=ue,R=re,y=pe,C=_e,B=ie,ee=de,P=be,te=ye,oe=fe,le=ce,ae=me,D=Be("perms");return p(),b("div",null,[o(m,{class:"!border-none",shadow:"never"},{default:e(()=>[o(Z,{content:"客户详情",onBack:r[0]||(r[0]=l=>t.$router.back())})]),_:1}),o(m,{class:"mt-4 !border-none",header:"基本信息",shadow:"never"},{default:e(()=>[o(R,{column:3,border:""},{default:e(()=>[o(u,{label:"手机号"},{default:e(()=>[s(n(a(_).mobile),1)]),_:1}),o(u,{label:"微信号"},{default:e(()=>[s(n(a(_).wechat||"-"),1)]),_:1}),o(u,{label:"客户姓名"},{default:e(()=>[s(n(a(_).real_name||"-"),1)]),_:1}),o(u,{label:"客户来源"},{default:e(()=>[s(n(a(_).source_desc||"-"),1)]),_:1}),o(u,{label:"来源账号"},{default:e(()=>[s(n(a(_).source_account||"-"),1)]),_:1}),o(u,{label:"客户地区"},{default:e(()=>[s(n(a(_).region||"-"),1)]),_:1}),o(u,{label:"意向项目"},{default:e(()=>[s(n(a(_).project_items||"-"),1)]),_:1}),o(u,{label:"创建时间"},{default:e(()=>[s(n(a(_).create_time),1)]),_:1}),o(u,{label:"备注",span:3},{default:e(()=>[s(n(a(_).remark||"-"),1)]),_:1})]),_:1})]),_:1}),o(m,{class:"mt-4 !border-none",header:"跟进信息",shadow:"never"},{default:e(()=>[o(R,{column:3,border:""},{default:e(()=>[o(u,{label:"当前阶段"},{default:e(()=>[o(y,{type:q(a(_).stage)},{default:e(()=>[s(n(a(_).stage_desc),1)]),_:1},8,["type"])]),_:1}),o(u,{label:"状态"},{default:e(()=>[o(y,{type:H(a(_).status)},{default:e(()=>[s(n(a(_).status_desc),1)]),_:1},8,["type"])]),_:1}),o(u,{label:"客户类型"},{default:e(()=>[s(n(a(_).customer_type_desc||"未分类"),1)]),_:1}),o(u,{label:"负责人"},{default:e(()=>[s(n(a(_).owner_name||"-"),1)]),_:1}),o(u,{label:"协助员"},{default:e(()=>{var l;return[(l=a(_).assist_list)!=null&&l.length?(p(!0),b(I,{key:0},M(a(_).assist_list,z=>(p(),d(y,{key:z.id,size:"small",class:"mr-1"},{default:e(()=>[s(n(z.name),1)]),_:2},1024))),128)):(p(),b("span",Se,"-"))]}),_:1}),o(u,{label:"对接博主"},{default:e(()=>[s(n(a(_).blogger_name||"-"),1)]),_:1}),o(u,{label:"最后跟进"},{default:e(()=>[s(n(a(_).last_follow_time||"-"),1)]),_:1}),o(u,{label:"下次跟进"},{default:e(()=>[f("span",{class:Pe(K(a(_).remind_status))},n(a(_).next_follow_time||"-"),3)]),_:1}),o(u,{label:"是否转移"},{default:e(()=>[a(_).is_transferred?(p(),d(y,{key:0,type:"info"},{default:e(()=>r[5]||(r[5]=[s("已转移")])),_:1})):(p(),b("span",Ve,"-"))]),_:1})]),_:1}),f("div",$e,[S((p(),d(C,{type:"primary",onClick:X},{default:e(()=>r[6]||(r[6]=[s(" 添加跟进 ")])),_:1})),[[D,["report/follow/add"]]]),S((p(),d(C,{type:"warning",onClick:J},{default:e(()=>r[7]||(r[7]=[s(" 对接咨询 ")])),_:1})),[[D,["report/assignBlogger"]]]),S((p(),d(C,{onClick:Q},{default:e(()=>r[8]||(r[8]=[s(" 转移客户 ")])),_:1})),[[D,["report/transfer"]]])])]),_:1}),(j=a(_).intents)!=null&&j.length?(p(),d(m,{key:0,class:"mt-4 !border-none",header:"推咨询意向",shadow:"never"},{default:e(()=>[o(ee,{data:a(_).intents,border:""},{default:e(()=>[o(B,{label:"意向医院",prop:"hospital_name"}),o(B,{label:"意向项目",prop:"project_name"}),o(B,{label:"备注",prop:"remark"})]),_:1},8,["data"])]),_:1})):i("",!0),o(m,{class:"mt-4 !border-none",shadow:"never"},{header:e(()=>[f("div",Fe,[r[12]||(r[12]=f("span",null,"跟进记录",-1)),o(te,{modelValue:a(k),"onUpdate:modelValue":r[1]||(r[1]=l=>De(k)?k.value=l:null),size:"small",onChange:E},{default:e(()=>[o(P,{label:"all"},{default:e(()=>r[9]||(r[9]=[s("全部")])),_:1}),o(P,{label:"sales"},{default:e(()=>r[10]||(r[10]=[s("业务员跟进")])),_:1}),o(P,{label:"blogger"},{default:e(()=>r[11]||(r[11]=[s("博主跟进")])),_:1})]),_:1},8,["modelValue"])])]),default:e(()=>[o(le,null,{default:e(()=>[(p(!0),b(I,null,M(a(w),l=>(p(),d(oe,{key:l.id,timestamp:l.create_time,placement:"top"},{default:e(()=>[o(m,null,{default:e(()=>[f("div",Le,[f("span",null,[o(y,{size:"small",type:l.operator_kind===1?"primary":"warning"},{default:e(()=>[s(n(l.operator_kind_desc),1)]),_:2},1032,["type"]),f("span",Ne,n(l.operator_name),1)]),o(y,null,{default:e(()=>[s(n(l.stage_desc),1)]),_:2},1024)]),l.content?(p(),b("div",Oe,n(l.content),1)):i("",!0),W(l)?(p(),d(R,{key:1,column:2,size:"small",border:""},{default:e(()=>[l.customer_type_desc?(p(),d(u,{key:0,label:"客户类型"},{default:e(()=>[s(n(l.customer_type_desc),1)]),_:2},1024)):i("",!0),l.budget?(p(),d(u,{key:1,label:"预算"},{default:e(()=>[s(n(l.budget),1)]),_:2},1024)):i("",!0),l.style_pref?(p(),d(u,{key:2,label:"风格偏好"},{default:e(()=>[s(n(l.style_pref),1)]),_:2},1024)):i("",!0),l.concern?(p(),d(u,{key:3,label:"顾虑"},{default:e(()=>[s(n(l.concern),1)]),_:2},1024)):i("",!0),l.handoff_status?(p(),d(u,{key:4,label:"对接情况"},{default:e(()=>[s(n(l.handoff_status),1)]),_:2},1024)):i("",!0),l.latest_status?(p(),d(u,{key:5,label:"最新动态"},{default:e(()=>[s(n(l.latest_status),1)]),_:2},1024)):i("",!0),l.next_plan?(p(),d(u,{key:6,label:"下次计划"},{default:e(()=>[s(n(l.next_plan),1)]),_:2},1024)):i("",!0),l.next_follow_time?(p(),d(u,{key:7,label:"下次跟进"},{default:e(()=>[s(n(l.next_follow_time),1)]),_:2},1024)):i("",!0),l.remark?(p(),d(u,{key:8,label:"备注"},{default:e(()=>[s(n(l.remark),1)]),_:2},1024)):i("",!0)]),_:2},1024)):i("",!0)]),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1}),a(w).length?i("",!0):(p(),d(ae,{key:0,description:"暂无跟进记录"}))]),_:1}),a(x)?(p(),d(we,{key:1,ref_key:"followPopupRef",ref:L,"report-id":a(g),"stage-options":a($),"customer-type-options":a(F),onSuccess:Y,onClose:r[2]||(r[2]=l=>x.value=!1)},null,8,["report-id","stage-options","customer-type-options"])):i("",!0),a(h)?(p(),d(xe,{key:2,ref_key:"assignBloggerPopupRef",ref:N,"report-id":a(g),onSuccess:v,onClose:r[3]||(r[3]=l=>h.value=!1)},null,8,["report-id"])):i("",!0),a(T)?(p(),d(he,{key:3,ref_key:"transferPopupRef",ref:O,"report-ids":[a(g)],onSuccess:v,onClose:r[4]||(r[4]=l=>T.value=!1)},null,8,["report-ids"])):i("",!0)])}}});export{Tt as default};
