import{D,B as F,O as L,P as O,C as S,E as f}from"./element-plus-Dexv8m38.js";import{t as $}from"./report-Dk0xVeLs.js";import{g as N}from"./employee-CJ8eLApb.js";import{P}from"./index-CiZ7u30k.js";import{d as U,r as u,a0 as T,K as y,o as m,L as a,U as l,u as r,a as q,R as z,S as K,c as M,T as j,ab as A}from"./@vue-ygbFPFRc.js";const G={class:"text-primary font-bold"},Y=U({__name:"transfer-popup",props:{reportIds:{}},emits:["success","close"],setup(b,{expose:g,emit:E}){const v=b,i=E,p=u(),c=u(),t=T({to_uid:"",reason:""}),V={to_uid:[{required:!0,message:"请选择接手业务员",trigger:"change"}]},d=u([]),h=async()=>{try{const e=await N({page_no:1,page_size:200});d.value=(e==null?void 0:e.lists)||[]}catch(e){console.error(e)}},w=e=>{const o=e.real_name||e.nickname||e.account||`ID:${e.id}`,n=e.mobile?` (${e.mobile})`:"";return`${o}${n}`},x=()=>{var e;(e=p.value)==null||e.open(),h()},k=async()=>{var e;await((e=c.value)==null?void 0:e.validate());try{await $({report_ids:v.reportIds,to_uid:t.to_uid,reason:t.reason}),f.success("转移成功"),i("success"),_()}catch(o){f.error(o.msg||"转移失败")}},_=()=>{var e,o;(e=c.value)==null||e.resetFields(),t.to_uid="",t.reason="",(o=p.value)==null||o.close(),i("close")};return g({open:x}),(e,o)=>{const n=F,C=O,I=L,R=S,B=D;return m(),y(P,{ref_key:"popupRef",ref:p,title:"转移客户",async:!0,width:"500px",onConfirm:k,onClose:_},{default:a(()=>[l(B,{ref_key:"formRef",ref:c,model:r(t),rules:V,"label-width":"100px"},{default:a(()=>[l(n,{label:"转移数量"},{default:a(()=>[q("span",G,K(e.reportIds.length),1),o[2]||(o[2]=z(" 条线索 "))]),_:1}),l(n,{label:"接手业务员",prop:"to_uid"},{default:a(()=>[l(I,{modelValue:r(t).to_uid,"onUpdate:modelValue":o[0]||(o[0]=s=>r(t).to_uid=s),placeholder:"请选择接手业务员",filterable:"",class:"w-full"},{default:a(()=>[(m(!0),M(j,null,A(r(d),s=>(m(),y(C,{key:s.id,label:w(s),value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"转移原因",prop:"reason"},{default:a(()=>[l(R,{modelValue:r(t).reason,"onUpdate:modelValue":o[1]||(o[1]=s=>r(t).reason=s),type:"textarea",rows:3,placeholder:"请输入转移原因"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},512)}}});export{Y as _};
