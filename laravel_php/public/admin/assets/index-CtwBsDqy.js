import{D as ve,B as ye,C as be,O as we,P as ke,i as Ce,I as Te,L as Ve,M as xe,R as Re,r as Pe,d as he,p as Ee,n as Se,o as $e,K as Be}from"./element-plus-Dexv8m38.js";import{_ as Ue}from"./index.vue_vue_type_script_setup_true_lang-D_09Ie3h.js";import{_ as De}from"./index.vue_vue_type_script_setup_true_lang-k5looPxV.js";import{d as H,a0 as Ie,r as u,l as Oe,a1 as Le,at as Fe,c as k,o as s,U as o,K as i,P as C,L as l,u as a,a9 as Ke,T as O,ab as L,R as d,a as G,M as c,S as P,O as Me,i as Ne,n as T}from"./@vue-ygbFPFRc.js";import{K as ze,g as Ae}from"./@element-plus-X4lX9UBP.js";import{a as je}from"./vue-router-Cg6aTb_d.js";import{h as qe,g as Ge}from"./report-Dk0xVeLs.js";import{u as He}from"./usePaging-B2jDzebD.js";import{g as Je}from"./index-RwF53efZ.js";import{_ as Qe}from"./report-popup.vue_vue_type_script_setup_true_lang-VPgyYUY4.js";import{_ as We}from"./follow-popup.vue_vue_type_script_setup_true_lang-iUU6Z23A.js";import{_ as Xe}from"./assign-blogger-popup.vue_vue_type_script_setup_true_lang-CeyPLwPX.js";import{_ as Ye}from"./transfer-popup.vue_vue_type_script_setup_true_lang-DEoFXNQP.js";import"./lodash-es-C1lm3Iro.js";import"./dayjs-Bnps4p3p.js";import"./@popperjs-D_chPuIy.js";import"./async-validator-9PlIezaS.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./nprogress-UhqZPtFR.js";import"./pinia-CfRoOCaL.js";import"./axios-DIsA03vz.js";import"./lodash-CMKdTQec.js";import"./@vueuse-yz9uDhpq.js";import"./css-color-function-rr4n3v1N.js";import"./balanced-match-BdS7OldZ.js";import"./color-DYO1E7y4.js";import"./clone-Ddk2tjDh.js";import"./color-convert-DsNsD289.js";import"./color-name-Dju3oUBS.js";import"./color-string-pUQDDJII.js";import"./ms-CzQ2E3wO.js";import"./vue-clipboard3-BWi338pc.js";import"./clipboard-7pJsftR6.js";import"./echarts-CXZcVnUo.js";import"./tslib-BDyQ-Jie.js";import"./zrender-DO4NV0px.js";import"./highlight.js-BLB-XFKK.js";import"./@highlightjs-DS9t1Xn3.js";import"./index-CiZ7u30k.js";import"./blogger-Yc_pWcVi.js";import"./employee-CJ8eLApb.js";const Ze={class:"flex items-center mb-4"},et={key:1},tt={class:"flex justify-end mt-4"},ot=H({name:"reportLists"}),Gt=H({...ot,setup(lt){const J=je(),r=Ie({keyword:"",stage:"",status:"",customer_type:"",remind_status:"",start_time:"",end_time:""}),h=u([]),F=u([]),E=u([]),S=u(!1),$=u(!1),B=u(!1),V=u(!1),x=u(0),U=u([]),K=u(),M=u(),N=u(),D=u(),b=u([]),{pager:w,getLists:m,resetPage:z,resetParams:Q}=He({fetchFun:qe,params:r}),W=async()=>{try{const n=await Ge();h.value=n.stage_options||[],F.value=n.status_options||[],E.value=n.customer_type_options||[]}catch(n){console.error(n)}},X=n=>({1:"info",2:"",3:"warning",4:"primary",5:"success",51:"danger",6:"success"})[n]||"",Y=n=>({1:"primary",2:"success",3:"info"})[n]||"",Z=n=>({overdue:"text-red-500",today:"text-orange-500",future:"text-green-500",none:"text-gray-400"})[n]||"text-gray-400",ee=n=>{b.value=n.map(e=>e.id)},te=()=>{S.value=!0,T(()=>{var n;(n=K.value)==null||n.open()})},oe=n=>{const e=Je("report/detail");J.push({path:e||"/report/detail",query:{id:n.id}})},le=n=>{x.value=n.id,$.value=!0,T(()=>{var e;(e=M.value)==null||e.open()})},ae=n=>{x.value=n.id,B.value=!0,T(()=>{var e;(e=N.value)==null||e.open()})},ne=()=>{b.value.length&&(U.value=[...b.value],V.value=!0,T(()=>{var n;(n=D.value)==null||n.open()}))},se=n=>{U.value=[n.id],V.value=!0,T(()=>{var e;(e=D.value)==null||e.open()})},re=()=>{b.value=[],m()};return Oe(()=>{W(),m()}),Le(()=>{m()}),(n,e)=>{const pe=be,_=ye,g=ke,R=we,ie=De,f=Ce,ue=ve,A=Te,p=xe,I=Re,j=he,de=Pe,q=$e,me=Se,_e=Ee,fe=Ve,ce=Ue,v=Fe("perms"),ge=Be;return s(),k("div",null,[o(A,{class:"!border-none",shadow:"never"},{default:l(()=>[o(ue,{ref:"formRef",class:"mb-[-16px]",model:a(r),inline:!0},{default:l(()=>[o(_,{class:"w-[280px]",label:"关键词"},{default:l(()=>[o(pe,{modelValue:a(r).keyword,"onUpdate:modelValue":e[0]||(e[0]=t=>a(r).keyword=t),placeholder:"手机号/微信/姓名",clearable:"",onKeyup:Ke(a(z),["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),o(_,{class:"w-[160px]",label:"阶段"},{default:l(()=>[o(R,{modelValue:a(r).stage,"onUpdate:modelValue":e[1]||(e[1]=t=>a(r).stage=t),placeholder:"全部",clearable:""},{default:l(()=>[(s(!0),k(O,null,L(a(h),t=>(s(),i(g,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(_,{class:"w-[160px]",label:"状态"},{default:l(()=>[o(R,{modelValue:a(r).status,"onUpdate:modelValue":e[2]||(e[2]=t=>a(r).status=t),placeholder:"全部",clearable:""},{default:l(()=>[(s(!0),k(O,null,L(a(F),t=>(s(),i(g,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(_,{class:"w-[160px]",label:"客户类型"},{default:l(()=>[o(R,{modelValue:a(r).customer_type,"onUpdate:modelValue":e[3]||(e[3]=t=>a(r).customer_type=t),placeholder:"全部",clearable:""},{default:l(()=>[(s(!0),k(O,null,L(a(E),t=>(s(),i(g,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(_,{class:"w-[160px]",label:"提醒状态"},{default:l(()=>[o(R,{modelValue:a(r).remind_status,"onUpdate:modelValue":e[4]||(e[4]=t=>a(r).remind_status=t),placeholder:"全部",clearable:""},{default:l(()=>[o(g,{label:"超期",value:"overdue"}),o(g,{label:"今日",value:"today"}),o(g,{label:"未来",value:"future"})]),_:1},8,["modelValue"])]),_:1}),o(_,{label:"创建时间"},{default:l(()=>[o(ie,{startTime:a(r).start_time,"onUpdate:startTime":e[5]||(e[5]=t=>a(r).start_time=t),endTime:a(r).end_time,"onUpdate:endTime":e[6]||(e[6]=t=>a(r).end_time=t)},null,8,["startTime","endTime"])]),_:1}),o(_,null,{default:l(()=>[o(f,{type:"primary",onClick:a(z)},{default:l(()=>e[12]||(e[12]=[d("查询")])),_:1},8,["onClick"]),o(f,{onClick:a(Q)},{default:l(()=>e[13]||(e[13]=[d("重置")])),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1}),o(A,{class:"!border-none mt-4",shadow:"never"},{default:l(()=>[G("div",Ze,[c((s(),i(f,{type:"primary",onClick:te},{default:l(()=>e[14]||(e[14]=[d(" 客户报备 ")])),_:1})),[[v,["report/add"]]]),c((s(),i(f,{type:"warning",disabled:!a(b).length,onClick:ne},{default:l(()=>e[15]||(e[15]=[d(" 批量转移 ")])),_:1},8,["disabled"])),[[v,["report/transfer"]]])]),c((s(),i(fe,{size:"large",data:a(w).lists,onSelectionChange:ee},{default:l(()=>[o(p,{type:"selection",width:"55"}),o(p,{label:"手机号",prop:"mobile","min-width":"120"}),o(p,{label:"客户姓名","min-width":"100"},{default:l(({row:t})=>[d(P(t.real_name||"-"),1)]),_:1}),o(p,{label:"微信号",prop:"wechat","min-width":"120","show-overflow-tooltip":""}),o(p,{label:"客户来源",prop:"source_desc","min-width":"100"}),o(p,{label:"阶段","min-width":"90"},{default:l(({row:t})=>[o(I,{type:X(t.stage)},{default:l(()=>[d(P(t.stage_desc),1)]),_:2},1032,["type"])]),_:1}),o(p,{label:"状态","min-width":"80"},{default:l(({row:t})=>[o(I,{type:Y(t.status)},{default:l(()=>[d(P(t.status_desc),1)]),_:2},1032,["type"])]),_:1}),o(p,{label:"客户类型",prop:"customer_type_desc","min-width":"90"}),o(p,{label:"负责人",prop:"owner_name","min-width":"100"}),o(p,{label:"协助员","min-width":"120"},{default:l(({row:t})=>{var y;return[d(P(((y=t.assist_names)==null?void 0:y.join(", "))||"-"),1)]}),_:1}),o(p,{label:"博主",prop:"blogger_name","min-width":"100"}),o(p,{label:"提醒","min-width":"80"},{default:l(({row:t})=>[t.next_follow_time?(s(),i(de,{key:0,content:t.next_follow_time},{default:l(()=>[o(j,{class:Me(Z(t.remind_status))},{default:l(()=>[o(a(ze))]),_:2},1032,["class"])]),_:2},1032,["content"])):(s(),k("span",et,"-"))]),_:1}),o(p,{label:"转移","min-width":"60"},{default:l(({row:t})=>[t.is_transferred?(s(),i(I,{key:0,type:"info",size:"small"},{default:l(()=>e[16]||(e[16]=[d("转")])),_:1})):C("",!0)]),_:1}),o(p,{label:"最后跟进",prop:"last_follow_time","min-width":"140"}),o(p,{label:"创建时间",prop:"create_time","min-width":"160"}),o(p,{label:"操作",width:"200",fixed:"right"},{default:l(({row:t})=>[o(f,{type:"primary",link:"",onClick:y=>oe(t)},{default:l(()=>e[17]||(e[17]=[d("详情")])),_:2},1032,["onClick"]),c((s(),i(f,{type:"success",link:"",onClick:y=>le(t)},{default:l(()=>e[18]||(e[18]=[d(" 跟进 ")])),_:2},1032,["onClick"])),[[v,["report/follow/add"]]]),c((s(),i(_e,null,{dropdown:l(()=>[o(me,null,{default:l(()=>[c((s(),i(q,{onClick:y=>ae(t)},{default:l(()=>e[20]||(e[20]=[d(" 对接咨询 ")])),_:2},1032,["onClick"])),[[v,["report/assignBlogger"]]]),c((s(),i(q,{onClick:y=>se(t)},{default:l(()=>e[21]||(e[21]=[d(" 转移 ")])),_:2},1032,["onClick"])),[[v,["report/transfer"]]])]),_:2},1024)]),default:l(()=>[o(f,{type:"primary",link:""},{default:l(()=>[e[19]||(e[19]=d(" 更多")),o(j,{class:"el-icon--right"},{default:l(()=>[o(a(Ae))]),_:1})]),_:1})]),_:2},1024)),[[v,["report/assignBlogger","report/transfer"]]])]),_:1})]),_:1},8,["data"])),[[ge,a(w).loading]]),G("div",tt,[o(ce,{modelValue:a(w),"onUpdate:modelValue":e[7]||(e[7]=t=>Ne(w)?w.value=t:null),onChange:a(m)},null,8,["modelValue","onChange"])])]),_:1}),a(S)?(s(),i(Qe,{key:0,ref_key:"reportPopupRef",ref:K,onSuccess:a(m),onClose:e[8]||(e[8]=t=>S.value=!1)},null,8,["onSuccess"])):C("",!0),a($)?(s(),i(We,{key:1,ref_key:"followPopupRef",ref:M,"report-id":a(x),"stage-options":a(h),"customer-type-options":a(E),onSuccess:a(m),onClose:e[9]||(e[9]=t=>$.value=!1)},null,8,["report-id","stage-options","customer-type-options","onSuccess"])):C("",!0),a(B)?(s(),i(Xe,{key:2,ref_key:"assignBloggerPopupRef",ref:N,"report-id":a(x),onSuccess:a(m),onClose:e[10]||(e[10]=t=>B.value=!1)},null,8,["report-id","onSuccess"])):C("",!0),a(V)?(s(),i(Ye,{key:3,ref_key:"transferPopupRef",ref:D,"report-ids":a(U),onSuccess:re,onClose:e[11]||(e[11]=t=>V.value=!1)},null,8,["report-ids"])):C("",!0)])}}});export{Gt as default};
