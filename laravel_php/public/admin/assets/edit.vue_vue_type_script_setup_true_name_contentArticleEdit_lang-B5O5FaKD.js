import{D as q,a6 as A,a7 as G,B as K,C as O,_ as $,F as z,h as H,g as J}from"./element-plus-Dexv8m38.js";import{_ as M}from"./index.vue_vue_type_style_index_0_lang-BbQVWiJS.js";import{_ as Q}from"./picker-B75jrQ9B.js";import{r as u}from"./index-RwF53efZ.js";import{p as W}from"./project-CreSpfIK.js";import{P as X}from"./index-CiZ7u30k.js";import{d as x,r as m,b as Y,a0 as Z,K as ee,o as p,u as o,L as r,U as l,a as y,c as v,P as te,T as oe,ab as le,R as ae,S as se}from"./@vue-ygbFPFRc.js";function we(n){return u.get({url:"/content.article/lists",params:n})}function re(n){return u.get({url:"/content.article/detail",params:n})}function ne(n){return u.post({url:"/content.article/add",params:n})}function ie(n){return u.post({url:"/content.article/edit",params:n})}function be(n){return u.post({url:"/content.article/delete",params:n})}function ye(n){return u.post({url:"/content.article/status",params:n})}function xe(n){return u.post({url:"/content.article/featured",params:n})}const ue={class:"w-full border rounded p-3 max-h-[200px] overflow-y-auto bg-gray-50"},de={key:0,class:"text-gray-400 text-center py-2"},ce=x({name:"contentArticleEdit"}),he=x({...ce,emits:["success","close"],setup(n,{expose:h,emit:k}){const V=k,_=m(),g=m(),f=m("add"),d=m([]),E=Y(()=>f.value==="add"?"添加文章":"编辑文章"),e=Z({id:0,project_ids:[],title:"",summary:"",cover:"",images:[],content:"",tags:"",sort:0,is_featured:1,is_show:1}),C=async()=>{try{const i=await W();d.value=i||[]}catch(i){console.error("获取项目列表失败:",i),d.value=[]}},U={title:[{required:!0,message:"请输入标题",trigger:"blur"}]},j=()=>{e.id=0,e.project_ids=[],e.title="",e.summary="",e.cover="",e.images=[],e.content="",e.tags="",e.sort=0,e.is_featured=1,e.is_show=1},R=async(i,t)=>{var c;if(f.value=i,j(),(c=_.value)==null||c.open(),await C(),i==="edit"&&t){const a=await re({id:t});e.id=a.id,e.project_ids=a.project_ids||[],e.title=a.title||"",e.summary=a.summary||"",e.cover=a.cover||"",e.images=a.images||[],e.content=a.content||"",e.tags=a.tags||"",e.sort=a.sort||0,e.is_featured=a.is_featured??0,e.is_show=a.is_show??1}},F=async()=>{var i,t;await((i=g.value)==null?void 0:i.validate()),f.value==="edit"?await ie(e):await ne(e),(t=_.value)==null||t.close(),V("success")},B=()=>{V("close")};return h({open:R}),(i,t)=>{const c=O,a=K,D=Q,L=z,N=$,S=H,w=J,b=G,P=M,I=A,T=q;return p(),ee(X,{ref_key:"popupRef",ref:_,title:o(E),async:!0,width:"900px",onConfirm:F,onClose:B},{default:r(()=>[l(T,{ref_key:"formRef",ref:g,model:o(e),rules:U,"label-width":"100px"},{default:r(()=>[l(I,{gutter:20},{default:r(()=>[l(b,{span:12},{default:r(()=>[l(a,{label:"标题",prop:"title"},{default:r(()=>[l(c,{modelValue:o(e).title,"onUpdate:modelValue":t[0]||(t[0]=s=>o(e).title=s),placeholder:"请输入标题",maxlength:"150","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(a,{label:"摘要",prop:"summary"},{default:r(()=>[l(c,{modelValue:o(e).summary,"onUpdate:modelValue":t[1]||(t[1]=s=>o(e).summary=s),type:"textarea",rows:3,placeholder:"请输入摘要",maxlength:"255","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(a,{label:"封面图",prop:"cover"},{default:r(()=>[l(D,{modelValue:o(e).cover,"onUpdate:modelValue":t[2]||(t[2]=s=>o(e).cover=s),limit:1},null,8,["modelValue"])]),_:1}),l(a,{label:"项目类型",prop:"project_ids"},{default:r(()=>[y("div",ue,[l(N,{modelValue:o(e).project_ids,"onUpdate:modelValue":t[3]||(t[3]=s=>o(e).project_ids=s)},{default:r(()=>[(p(!0),v(oe,null,le(o(d),s=>(p(),v("div",{key:s.id,class:"py-1"},[l(L,{label:s.id},{default:r(()=>[ae(se(s.name),1)]),_:2},1032,["label"])]))),128))]),_:1},8,["modelValue"]),!o(d)||o(d).length===0?(p(),v("div",de,' 暂无项目类型，请先在"项目配置"中添加 ')):te("",!0)])]),_:1}),l(a,{label:"排序",prop:"sort"},{default:r(()=>[l(S,{modelValue:o(e).sort,"onUpdate:modelValue":t[4]||(t[4]=s=>o(e).sort=s),min:0,max:9999},null,8,["modelValue"]),t[8]||(t[8]=y("div",{class:"form-tips"},"数值越大越靠前",-1))]),_:1}),l(a,{label:"加精",prop:"is_featured"},{default:r(()=>[l(w,{modelValue:o(e).is_featured,"onUpdate:modelValue":t[5]||(t[5]=s=>o(e).is_featured=s),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),l(a,{label:"上架状态",prop:"is_show"},{default:r(()=>[l(w,{modelValue:o(e).is_show,"onUpdate:modelValue":t[6]||(t[6]=s=>o(e).is_show=s),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1}),l(b,{span:12},{default:r(()=>[l(a,{label:"内容详情",prop:"content"},{default:r(()=>[l(P,{modelValue:o(e).content,"onUpdate:modelValue":t[7]||(t[7]=s=>o(e).content=s),height:500},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])}}});export{he as _,we as a,be as b,ye as c,xe as d};
