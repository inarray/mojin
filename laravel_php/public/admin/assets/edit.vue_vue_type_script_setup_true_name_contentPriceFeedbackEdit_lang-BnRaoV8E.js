import{D as q,a6 as A,a7 as G,B as K,C as O,_ as $,F as z,h as H,g as J}from"./element-plus-Dexv8m38.js";import{_ as M}from"./index.vue_vue_type_style_index_0_lang-BbQVWiJS.js";import{_ as Q}from"./picker-B75jrQ9B.js";import{r as u}from"./index-RwF53efZ.js";import{p as W}from"./project-CreSpfIK.js";import{P as X}from"./index-CiZ7u30k.js";import{d as y,r as p,b as Y,a0 as Z,K as ee,o as m,u as o,L as n,U as a,a as w,c as b,P as te,T as oe,ab as ae,R as le,S as re}from"./@vue-ygbFPFRc.js";function ve(s){return u.get({url:"/content.priceFeedback/lists",params:s})}function ne(s){return u.get({url:"/content.priceFeedback/detail",params:s})}function se(s){return u.post({url:"/content.priceFeedback/add",params:s})}function ie(s){return u.post({url:"/content.priceFeedback/edit",params:s})}function ke(s){return u.post({url:"/content.priceFeedback/delete",params:s})}function we(s){return u.post({url:"/content.priceFeedback/status",params:s})}function ye(s){return u.post({url:"/content.priceFeedback/featured",params:s})}const ue={class:"w-full border rounded p-3 max-h-[200px] overflow-y-auto bg-gray-50"},de={key:0,class:"text-gray-400 text-center py-2"},ce=y({name:"contentPriceFeedbackEdit"}),Fe=y({...ce,emits:["success","close"],setup(s,{expose:F,emit:x}){const g=x,_=p(),V=p(),f=p("add"),c=p([]),h=Y(()=>f.value==="add"?"添加内容":"编辑内容"),e=Z({id:0,project_ids:[],title:"",summary:"",cover:"",images:[],content:"",price_range:"",sort:0,is_featured:1,is_show:1}),E=async()=>{try{const i=await W();c.value=i||[]}catch(i){console.error("获取项目列表失败:",i),c.value=[]}},C={title:[{required:!0,message:"请输入标题",trigger:"blur"}]},U=()=>{e.id=0,e.project_ids=[],e.title="",e.summary="",e.cover="",e.images=[],e.content="",e.price_range="",e.sort=0,e.is_featured=1,e.is_show=1},j=async(i,t)=>{var d;if(f.value=i,U(),(d=_.value)==null||d.open(),await E(),i==="edit"&&t){const l=await ne({id:t});e.id=l.id,e.project_ids=l.project_ids||[],e.title=l.title||"",e.summary=l.summary||"",e.cover=l.cover||"",e.images=l.images||[],e.content=l.content||"",e.price_range=l.price_range||"",e.sort=l.sort||0,e.is_featured=l.is_featured??0,e.is_show=l.is_show??1}},R=async()=>{var i,t;await((i=V.value)==null?void 0:i.validate()),f.value==="edit"?await ie(e):await se(e),(t=_.value)==null||t.close(),g("success")},B=()=>{g("close")};return F({open:j}),(i,t)=>{const d=O,l=K,D=Q,L=z,N=$,P=H,v=J,k=G,S=M,I=A,T=q;return m(),ee(X,{ref_key:"popupRef",ref:_,title:o(h),async:!0,width:"900px",onConfirm:R,onClose:B},{default:n(()=>[a(T,{ref_key:"formRef",ref:V,model:o(e),rules:C,"label-width":"100px"},{default:n(()=>[a(I,{gutter:20},{default:n(()=>[a(k,{span:12},{default:n(()=>[a(l,{label:"标题",prop:"title"},{default:n(()=>[a(d,{modelValue:o(e).title,"onUpdate:modelValue":t[0]||(t[0]=r=>o(e).title=r),placeholder:"请输入标题",maxlength:"150","show-word-limit":""},null,8,["modelValue"])]),_:1}),a(l,{label:"摘要",prop:"summary"},{default:n(()=>[a(d,{modelValue:o(e).summary,"onUpdate:modelValue":t[1]||(t[1]=r=>o(e).summary=r),type:"textarea",rows:3,placeholder:"请输入摘要",maxlength:"255","show-word-limit":""},null,8,["modelValue"])]),_:1}),a(l,{label:"价格区间",prop:"price_range"},{default:n(()=>[a(d,{modelValue:o(e).price_range,"onUpdate:modelValue":t[2]||(t[2]=r=>o(e).price_range=r),placeholder:"如：3980-8980",maxlength:"100"},null,8,["modelValue"])]),_:1}),a(l,{label:"封面图",prop:"cover"},{default:n(()=>[a(D,{modelValue:o(e).cover,"onUpdate:modelValue":t[3]||(t[3]=r=>o(e).cover=r),limit:1},null,8,["modelValue"])]),_:1}),a(l,{label:"项目类型",prop:"project_ids"},{default:n(()=>[w("div",ue,[a(N,{modelValue:o(e).project_ids,"onUpdate:modelValue":t[4]||(t[4]=r=>o(e).project_ids=r)},{default:n(()=>[(m(!0),b(oe,null,ae(o(c),r=>(m(),b("div",{key:r.id,class:"py-1"},[a(L,{label:r.id},{default:n(()=>[le(re(r.name),1)]),_:2},1032,["label"])]))),128))]),_:1},8,["modelValue"]),!o(c)||o(c).length===0?(m(),b("div",de,' 暂无项目类型，请先在"项目配置"中添加 ')):te("",!0)])]),_:1}),a(l,{label:"排序",prop:"sort"},{default:n(()=>[a(P,{modelValue:o(e).sort,"onUpdate:modelValue":t[5]||(t[5]=r=>o(e).sort=r),min:0,max:9999},null,8,["modelValue"]),t[9]||(t[9]=w("div",{class:"form-tips"},"数值越大越靠前",-1))]),_:1}),a(l,{label:"加精",prop:"is_featured"},{default:n(()=>[a(v,{modelValue:o(e).is_featured,"onUpdate:modelValue":t[6]||(t[6]=r=>o(e).is_featured=r),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),a(l,{label:"上架状态",prop:"is_show"},{default:n(()=>[a(v,{modelValue:o(e).is_show,"onUpdate:modelValue":t[7]||(t[7]=r=>o(e).is_show=r),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1}),a(k,{span:12},{default:n(()=>[a(l,{label:"内容详情",prop:"content"},{default:n(()=>[a(S,{modelValue:o(e).content,"onUpdate:modelValue":t[8]||(t[8]=r=>o(e).content=r),height:500},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])}}});export{Fe as _,ke as a,we as b,ye as c,ve as p};
