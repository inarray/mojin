import{I as S}from"./element-plus-Dexv8m38.js";import{H as x}from"./vue-echarts-et4GGQOV.js";import{a as L}from"./vue-router-Cg6aTb_d.js";import{F as B,d as P}from"./index-RwF53efZ.js";import{u as _}from"./getExposeType-DuVYxcJe.js";import{d as b,a0 as p,l as W,c as u,o as f,U as l,a as e,L as a,T as z,ab as R,u as i,_ as g,S as n}from"./@vue-ygbFPFRc.js";import"./@element-plus-X4lX9UBP.js";import"./lodash-es-C1lm3Iro.js";import"./dayjs-Bnps4p3p.js";import"./@popperjs-D_chPuIy.js";import"./async-validator-9PlIezaS.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./resize-detector-G6vbKCU7.js";import"./echarts-CXZcVnUo.js";import"./tslib-BDyQ-Jie.js";import"./zrender-DO4NV0px.js";import"./nprogress-UhqZPtFR.js";import"./pinia-CfRoOCaL.js";import"./axios-DIsA03vz.js";import"./lodash-CMKdTQec.js";import"./@vueuse-yz9uDhpq.js";import"./css-color-function-rr4n3v1N.js";import"./balanced-match-BdS7OldZ.js";import"./color-DYO1E7y4.js";import"./clone-Ddk2tjDh.js";import"./color-convert-DsNsD289.js";import"./color-name-Dju3oUBS.js";import"./color-string-pUQDDJII.js";import"./ms-CzQ2E3wO.js";import"./vue-clipboard3-BWi338pc.js";import"./clipboard-7pJsftR6.js";import"./highlight.js-BLB-XFKK.js";import"./@highlightjs-DS9t1Xn3.js";const A={class:"workbench"},D={class:"flex justify-between items-center"},F={class:"text-tx-secondary text-xs"},O={class:"flex flex-wrap gap-4"},T=["onClick"],$={class:"text-sm text-tx-secondary mb-2"},E={class:"text-xs text-tx-secondary mt-1"},I={class:"lg:flex gap-4"},N=b({name:"workbench"}),V=b({...N,setup(j){const h=L(),v=_(),y=_(),r=p({stats:[],total:0}),c=p({tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",right:"5%",top:"center",data:[]},series:[{name:"客户阶段",type:"pie",radius:["40%","70%"],center:["40%","50%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:8,borderColor:"#fff",borderWidth:2},label:{show:!0,formatter:`{b}
{c}`},emphasis:{label:{show:!0,fontSize:16,fontWeight:"bold"}},data:[]}]}),d=p({tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:[],axisTick:{alignWithLabel:!0}},yAxis:{type:"value",name:"客户数"},series:[{name:"客户数",type:"bar",barWidth:"60%",data:[],itemStyle:{borderRadius:[4,4,0,0]}}]}),w=o=>r.total===0?"0.0":(o/r.total*100).toFixed(1),C=o=>{o===0?h.push("/consumer/lists"):h.push(`/consumer/lists?stage=${o}`)},k=()=>{B().then(o=>{o.customer_stage&&(r.stats=o.customer_stage.stats||[],r.total=o.customer_stage.total||0,c.legend.data=r.stats.map(t=>t.name),c.series[0].data=r.stats.map(t=>({value:t.value,name:t.name,itemStyle:{color:t.color}})),d.xAxis.data=r.stats.map(t=>t.name),d.series[0].data=r.stats.map(t=>({value:t.value,itemStyle:{color:t.color}})))}).catch(o=>{console.log("err",o)})};return W(()=>{k()}),(o,t)=>{const m=S;return f(),u("div",A,[l(m,{class:"!border-none mb-4",shadow:"never"},{header:a(()=>[e("div",D,[t[0]||(t[0]=e("span",{class:"card-title"},"客户阶段统计",-1)),e("span",F," 总客户数："+n(i(r).total),1)])]),default:a(()=>[e("div",O,[(f(!0),u(z,null,R(i(r).stats,s=>(f(),u("div",{key:s.stage,class:"stage-card flex-1 min-w-[140px] p-4 rounded-lg cursor-pointer transition-all hover:shadow-md",style:g({backgroundColor:s.color+"15",borderLeft:`4px solid ${s.color}`}),onClick:H=>C(s.stage)},[e("div",$,n(s.name),1),e("div",{class:"text-3xl font-bold",style:g({color:s.color})},n(s.value),5),e("div",E," 占比 "+n(w(s.value))+"% ",1)],12,T))),128))])]),_:1}),e("div",I,[l(m,{class:"!border-none mb-4 lg:mb-0 w-full lg:w-1/2",shadow:"never"},{header:a(()=>t[1]||(t[1]=[e("span",null,"客户阶段分布（饼图）",-1)])),default:a(()=>[e("div",null,[l(i(x),{ref_key:"customerPieChart",ref:v,style:{height:"350px"},option:i(c),autoresize:!0},null,8,["option"])])]),_:1}),l(m,{class:"!border-none w-full lg:w-1/2",shadow:"never"},{header:a(()=>t[2]||(t[2]=[e("span",null,"客户阶段分布（柱状图）",-1)])),default:a(()=>[e("div",null,[l(i(x),{ref_key:"customerBarChart",ref:y,style:{height:"350px"},option:i(d),autoresize:!0},null,8,["option"])])]),_:1})])])}}}),kt=P(V,[["__scopeId","data-v-c2bfbea8"]]);export{kt as default};
