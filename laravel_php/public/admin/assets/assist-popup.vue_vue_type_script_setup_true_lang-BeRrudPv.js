import{D as F,B as R,O as V,P as $,E as y}from"./element-plus-Dexv8m38.js";import{k as D,l as L}from"./consumer-B-5sexIM.js";import{P}from"./index-CiZ7u30k.js";import{d as A,r as m,a0 as S,K as b,o as p,L as t,U as i,u as a,c as U,T as q,ab as K}from"./@vue-ygbFPFRc.js";const z=A({__name:"assist-popup",props:{customerId:{},ownerEmployeeId:{}},emits:["success","close"],setup(E,{expose:w,emit:h}){const u=E,d=h,n=m(),r=m(),s=S({employee_id:""}),v={employee_id:[{required:!0,message:"请选择业务员",trigger:"change"}]},_=m([]),g=async()=>{try{const e=await L({owner_employee_id:u.ownerEmployeeId||0});_.value=(e==null?void 0:e.lists)||[]}catch(e){console.error(e)}},k=e=>{const o=e.real_name||e.nickname||e.account||`ID:${e.id}`,c=e.mobile?` (${e.mobile})`:"";return`${o}${c}`},x=()=>{var e;(e=n.value)==null||e.open(),g()},C=async()=>{var e;await((e=r.value)==null?void 0:e.validate());try{await D({customer_id:u.customerId,employee_id:s.employee_id}),y.success("指派成功"),d("success"),f()}catch(o){y.error(o.msg||"指派失败")}},f=()=>{var e,o;(e=r.value)==null||e.resetFields(),s.employee_id="",(o=n.value)==null||o.close(),d("close")};return w({open:x}),(e,o)=>{const c=$,I=V,O=R,B=F;return p(),b(P,{ref_key:"popupRef",ref:n,title:"指派协助员",async:!0,width:"500px",onConfirm:C,onClose:f},{default:t(()=>[i(B,{ref_key:"formRef",ref:r,model:a(s),rules:v,"label-width":"100px"},{default:t(()=>[i(O,{label:"协助业务员",prop:"employee_id"},{default:t(()=>[i(I,{modelValue:a(s).employee_id,"onUpdate:modelValue":o[0]||(o[0]=l=>a(s).employee_id=l),placeholder:"请选择协助业务员",filterable:"",class:"w-full"},{default:t(()=>[(p(!0),U(q,null,K(a(_),l=>(p(),b(c,{key:l.id,label:k(l),value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},512)}}});export{z as _};
